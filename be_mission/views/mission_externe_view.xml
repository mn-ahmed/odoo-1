<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- form view Mission Externe -->
    <record id="mission_form_view" model="ir.ui.view">
      <field name="name">mission_view_form</field>
      <field name="model">mission.externe</field>
      <field name="arch" type="xml">
        <form string="Mission">
          <header>
            <!--button name="action_cancel" type="object" string="Annuler" states="draft" /-->
            <button name="action_arriver" type="object" string="Arrivé" states="draft" class="btn-primary" attrs="{'invisible': [('state','not in','draft')]}"/>
            <button name="action_depart" type="object" string="Depart" states="arriver" class="btn-primary" attrs="{'invisible': [('state','not in','arriver')]}"/>
            <button name="action_terminer" type="object" string="Terminé" states="depart" class="btn-primary" attrs="{'invisible': [('state','not in','depart')]}"/>
            <field name="state" widget="statusbar" string="confirmé" statusbar_visible="draft,arriver,depart ,terminer" />
          </header>
          <sheet>
            <div class="oe_title">
              <h1>
                <field name="name" readonly="1"/>
              </h1>
            </div>
            <group>
              <group>
                <field name="person_name" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                <field name="passport" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
              </group>
              <group>
                <field name="date" readonly="1"/>
                <field name="date_exp" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
              </group>
            </group>
            <notebook>
              <page string="Arrivé" attrs="{'invisible': [('state','not in',('draft','arriver','terminer'))]}">
                <group >
                <group>
                  <field name="date_arriver" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                   <label for="test_ca" string="Test COVID / Date"/>
                      <div class="o_row" name="test_ca" >
                          <field name="test_ca" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                          <field name="date_ca" attrs="{'invisible':[('test_ca', 'not in',('oui'))],'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                      </div>
              </group>
                 <group>
                  <label for="visa" string="VISA / Date" />
                  <div class="o_row" name="visa">
                    <field name="visa" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                    <field name="date_visa" attrs="{'invisible':[('visa', 'not in',('oui'))], 'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                  </div>
                  <label for="l_invitation" string="Lettre d'invitation"/>
                      <div class="o_row" name="l_invitation" >
                          <field name="l_invitation" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                          <field name="date_lettre" attrs="{'invisible':[('l_invitation', 'not in',('oui'))],'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                      </div>

              </group>
                </group>
                <group>
              <field name="objet" string="Objet Mission" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
            </group>
                <group>
              <group>
                <field name="post_v" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                <field name="hotel" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                <field name="frais_h" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                <field name="commentaire" attrs="{'invisible':[('frais_h', 'not in',('autres'))], 'readonly': [('state', 'not in', ('draft','arriver'))] }" />
              </group>
              <group>
                <label for="duree_s" string="Durée du séjour" />
                <div class="o_row" name="duree_s">
                  <field name="duree_s" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                  <field name="unity_sejour" attrs="{'invisible':[('duree_s', '==', False)],'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                </div>
                <label for="duree_h" string="Durée du séjour hôtel" />
                <div class="o_row" name="duree_h">
                  <field name="duree_h" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                  <field name="unity_sejour_hotel" attrs="{'invisible':[('duree_h', '==', False)],'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                </div>
                <field name="chauffeur" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
              </group>
            </group>
                <group attrs="{'invisible':[('chauffeur', '==', False)] }">
                   <group>
                <field name="n_chauffeur" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                <field name="chauffeur_cont" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
              </group>
              <group >
                <field name="matricule" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                <label for="duree_b" string="Durée d'utilisation du Véhicule" />
                 <div class="o_row" name="duree_b">
                  <field name="duree_b" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                  <field name="unity_duree_vehicule" attrs="{'invisible':[('duree_b', '==', False)],'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                </div>
              </group>
            </group>
            <group>
              <group>
                <field name="responsable" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
              </group>
              <group>
                <field name="post" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
              </group>
            </group>

              </page>
              <page string="Départ" attrs="{'invisible': [('state','not in',('depart','terminer'))]}">
                <group >
                  <group>
                    <field name="date_depart" attrs="{'readonly': [('state', '!=', 'depart')]}"/>
                    <label for="test_cd" string="Test COVID / Date"/>
                      <div class="o_row" name="test_cd" >
                          <field name="test_cd" attrs="{'readonly': [('state', '!=', 'depart')]}"/>
                          <field name="date_cd" attrs="{'invisible': [('test_cd','not in','oui')],'readonly': [('state', '!=', 'depart')]}"/>
                      </div>
                  </group>
                  <group>
                    <field name="satisfact" attrs="{'readonly': [('state', '!=', 'depart')]}"/>
                  </group>
                </group>
              </page>
            </notebook>

          </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
        </form>
      </field>
    </record>

        <!-- treeview Mission Externe-->
    <record model="ir.ui.view" id="mission_externe_treeview">
      <field name="name">Mission</field>
      <field name="model">mission.externe</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name" />
          <field name="person_name" />
          <field name="passport"/>
          <field name="date_arriver" />
          <field name="date_depart" />
          <field name="state" />
        </tree>
      </field>
    </record>

       <!-- Mession externe arrivé action -->
    <record model="ir.actions.act_window" id="mission_externe_ar_action_window">
      <field name="name">Mission Externe</field>
      <field name="res_model">mission.externe</field>
      <field name="view_id" ref="mission_externe_treeview"/>
      <field name="view_mode">tree,form</field>
    </record>

    </data>
</odoo>