<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

    <!-- tree view Mission Ordinaire-->
    <record model="ir.ui.view" id="mission_ordinaire_treeview">
      <field name="name">Mission</field>
      <field name="model">mission.ordinaire</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name" />
          <field name="employee_id" />
          <field name="passport" />
          <field name="date_depart" />
          <field name="date_retour" />
          <field name="state"/>
        </tree>
      </field>
    </record>

    <!-- form view Mission ordinaire -->
    <record id="mission_form_view_ordinaire" model="ir.ui.view">
      <field name="name">mission_view_form</field>
      <field name="model">mission.ordinaire</field>
      <field name="arch" type="xml">
        <form string="Mission">
          <header>
            <!--button name="action_cancel" type="object" string="Annuler" states="draft" /-->
            <button name="action_depart" type="object" string="Départ" states="draft" class="btn-primary" attrs="{'invisible': [('state','not in','draft')]}"/>
            <button name="action_retour" type="object" string="Retour" states="depart" class="btn-primary" attrs="{'invisible': [('state','not in','depart')]}"/>
            <button name="action_terminer" type="object" string="Terminé" states="retour" class="btn-primary" attrs="{'invisible': [('state','not in','retour')]}"/>
            <field name="state" widget="statusbar" string="confirmé" statusbar_visible="draft,depart,retour,terminer" />
          </header>
          <sheet>
            <div class="oe_title">
              <h1>
                <field name="name" readonly="1"/>
              </h1>
            </div>
            <group>
              <group>
                <field name="employee_id" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                <field name="passport" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
              </group>
              <group>
                <field name="date" />
                <field name="date_exp" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
              </group>
            </group>
            <notebook>
              <page string="Départ" attrs="{'invisible': [('state','not in',('draft','depart','terminer'))]}">
                <group>
                  <group>
                    <field name="date_depart" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>

                    <label for="o_mission" string="Ordre de mission"/>
                    <div class="o_row" name="o_mission">
                      <field name="o_mission" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                      <field name="date_mission" attrs="{'invisible':[('o_mission', 'not in', 'oui')],'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                    </div>
                  </group>
                  <group>
                    <field name="vehicule" attrs="{'readonly':[('state','not in',('draft','depart'))]}" />
                  </group>
                </group>
                <group attrs="{'invisible':[('vehicule', 'not in', 'oui')]}">
                  <group>
                    <field name="n_chauffeur" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                    <field name="chauffeur_cont" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                    <label for="p_carburant" string="Carburant"/>
                    <div class="o_row" name="p_carburant" >
                      <field name="p_carburant" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                      <field name="date_p_carburant" attrs="{'invisible':[('p_carburant', 'not in',('oui'))],'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                    </div>
                  </group>
                  <group>
                    <field name="matricule" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                    <label for="duree_b" string="Durée d'utilisation du Véhicule" />
                     <div class="o_row" name="duree_b">
                        <field name="duree_b" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                      <field name="unity_duree_vehicule" attrs="{'readonly': [('state', 'not in', ('draft','arriver'))]}"/>
                    </div>
                  </group>
                </group>
                <group>
                  <group>
                    <field name="frais_m" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                    <field name="equipement" attrs="{'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                  </group>
                  <group>
                    <field name="date_f" attrs="{'readonly': [('state', 'not in', ('draft','depart'))],'invisible':[('frais_m', 'not in', 'oui')] }"/>
                    <field name="date_q" attrs="{'invisible':[('equipement', 'not in', 'oui')],'readonly': [('state', 'not in', ('draft','depart'))]}"/>
                  </group>
                </group>
                <group>
                  <field name="commentaire_dep" string="Commentaire" />
                </group>
              </page>
              <page string="Retour" attrs="{'invisible': [('state','not in',('retour','terminer'))]}">
                <group>
                  <group>
                    <field name="date_retour" attrs="{'readonly': [('state', 'not in', ('retour'))]}"/>
                  </group>
                  <group>
<!--                    <label for="test_cr" string="Test COVID / Date"/>-->
<!--                    <div class="o_row" name="test_cr" >-->
<!--                      <field name="test_cr" attrs="{'readonly': [('state', 'not in', ('retour'))]}"/>-->
<!--                      <field name="date_cr" attrs="{'invisible':[('test_cr', 'not in', 'oui')],'readonly': [('state', 'not in', ('retour'))]}"/>-->
<!--                    </div>-->
                  </group>
                </group>
                <group>
                  <group>
                    <field name="p_financier" attrs="{'readonly': [('state', 'not in', ('retour'))]}"/>
                    <field name="p_equipement" attrs="{'readonly': [('state', 'not in', ('retour'))]}"/>
                  </group>
                  <group>
                    <field name="date_pf" attrs="{'readonly': [('state', 'not in', ('retour'))],'invisible':[('p_financier', 'not in', 'oui')] }" />
                    <field name="date_p_eq" attrs="{'readonly': [('state', 'not in', ('retour'))],'invisible':[('p_equipement', 'not in', 'oui')] }" />
                  </group>
                </group>
                <group>
                  <field name="commentaire_ret" string="Commentaire" />
                </group>
              </page>
            </notebook>
          </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
        </form>
      </field>
    </record>

    <!-- Mession ordinaire actions-->
    <record model="ir.actions.act_window" id="mission_ordinaire_ar_action_window">
      <field name="name">Mission Ordinaire</field>
      <field name="res_model">mission.ordinaire</field>
      <field name="view_mode">tree,form</field>
    </record>

    </data>
</odoo>